(()=>{var e={};e.id=486,e.ids=[486],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},4643:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o}),r(1856),r(6989),r(5866),r(6694);var s=r(3191),a=r(8716),n=r(7922),i=r.n(n),d=r(5231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);r.d(t,l);let o=["",{children:["(dashboard)",{children:["management",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1856)),"/workspace/frontend/src/app/(dashboard)/management/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6989)),"/workspace/frontend/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6694)),"/workspace/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/workspace/frontend/src/app/(dashboard)/management/page.tsx"],u="/(dashboard)/management/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/management/page",pathname:"/management",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3021:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},2001:(e,t,r)=>{Promise.resolve().then(r.bind(r,4690))},4149:(e,t,r)=>{Promise.resolve().then(r.bind(r,2515))},9874:(e,t,r)=>{Promise.resolve().then(r.bind(r,4072))},5047:(e,t,r)=>{"use strict";var s=r(7389);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},2515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(326),a=r(7577),n=r(5047),i=r(4690),d=r(9404),l=r.n(d);r(1471);let o=[{name:"Overview",path:"/",icon:"\uD83D\uDCCA"},{name:"Tickets",path:"/tickets",icon:"\uD83C\uDFAB",permission:"VIEW_TICKETS"},{name:"Infractions",path:"/infractions",icon:"⚠️",permission:"VIEW_INFRACTIONS"},{name:"Analytics",path:"/analytics",icon:"\uD83D\uDCC8",permission:"VIEW_ANALYTICS"},{name:"Management",path:"/management",icon:"⚙️",permission:"MANAGE_USERS",adminOnly:!0},{name:"Settings",path:"/settings",icon:"\uD83D\uDD27"}];function c(){let e=(0,n.usePathname)(),{user:t,loading:r}=(0,i.a)(),{hasPermission:d,loading:c}=function(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0);return{permissions:e,loading:r,hasPermission:t=>!r&&e.includes(t)}}(),u=t?.rank&&t.rank>=16&&t.rank<=255,m=o.filter(e=>!!r||!!c||(!e.adminOnly||!!u)&&(!e.permission||!!d(e.permission)));return(0,s.jsxs)("nav",{className:"bg-dark-card border-r border-dark-border min-h-screen w-64 p-4",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-white flex items-center space-x-2",children:[s.jsx("span",{children:"\uD83D\uDD17"}),s.jsx("span",{children:"AHS Staff"})]}),t&&s.jsx("div",{className:"mt-2",children:s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${u?"bg-red-600":"bg-blue-600"} text-white`,children:u?"Admin":"Staff"})})]}),s.jsx("div",{className:"space-y-2",children:m.map(t=>{let r=e===t.path;return(0,s.jsxs)(l(),{href:t.path,className:`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${r?"bg-blue-600 text-white":"text-gray-300 hover:bg-dark-border hover:text-white"}`,children:[s.jsx("span",{className:"text-xl",children:t.icon}),s.jsx("span",{className:"font-medium",children:t.name})]},t.path)})}),t&&s.jsx("div",{className:"mt-auto pt-8 border-t border-dark-border",children:(0,s.jsxs)("button",{onClick:async()=>{},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-dark-border hover:text-white transition-colors",children:[s.jsx("span",{children:"\uD83D\uDEAA"}),s.jsx("span",{children:"Logout"})]})})]})}function u({children:e}){(0,n.useRouter)();let{user:t,loading:r}=(0,i.a)();return r?s.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsx("div",{className:"text-white text-xl",children:"Loading..."})}):t?(0,s.jsxs)("div",{className:"flex min-h-screen bg-dark-bg",children:[s.jsx(c,{}),s.jsx("main",{className:"flex-1",children:e})]}):null}},4072:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(326),a=r(7577),n=r(4690),i=r(1471);let d=["VIEW_DASHBOARD","VIEW_TICKETS","CLAIM_TICKETS","VIEW_INFRACTIONS","VIEW_ALL_INFRACTIONS","ISSUE_INFRACTIONS","VOID_INFRACTIONS","VIEW_ANALYTICS","MANAGE_PERMISSIONS","MANAGE_USERS","MANAGE_CHANNELS"];function l(){let{user:e}=(0,n.a)(),{users:t,channels:r,loading:l,error:o,refresh:c}=function(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)([]),[n,d]=(0,a.useState)(!0),[l,o]=(0,a.useState)(null);return{users:e,channels:r,loading:n,error:l,refresh:async()=>{try{d(!0),o(null);let[e,r]=await Promise.all([i.bM.getUsers(),i.bM.getTrackedChannels()]);t(e.data),s(r.data)}catch(e){o(e.response?.data?.error||"Failed to load management data")}finally{d(!1)}}}}(),u=!!(e?.rank&&e.rank>=16&&e.rank<=255),[m,x]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[b,g]=(0,a.useState)(null),f=(0,a.useMemo)(()=>t.filter(e=>null!==e.rank),[t]);if(!u)return(0,s.jsxs)("div",{className:"flex-1 p-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Management"}),s.jsx("div",{className:"text-red-400",children:"You are not authorized to view this page."})]});let v=async(e,t)=>{g(`status:${e.id}`);try{await i.bM.updateUserStatus(e.id,t),await c()}finally{g(null)}},y=async(e,t,r)=>{g(`perm:${e.id}:${t}`);try{await i.bM.updateUserPermission(e.id,t,r),await c()}finally{g(null)}},N=async()=>{g("addChannel");try{await i.bM.addTrackedChannel(m.trim(),h.trim()),x(""),p(""),await c()}finally{g(null)}},j=async e=>{g(`rmChannel:${e}`);try{await i.bM.removeTrackedChannel(e),await c()}finally{g(null)}};return(0,s.jsxs)("div",{className:"flex-1 p-8 space-y-10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Management"}),s.jsx("button",{onClick:c,className:"px-4 py-2 bg-dark-card border border-dark-border rounded text-white hover:bg-dark-border transition",children:"Refresh"})]}),l&&s.jsx("div",{className:"text-gray-400",children:"Loading management data..."}),o&&s.jsx("div",{className:"text-red-400",children:o}),(0,s.jsxs)("section",{className:"bg-dark-card border border-dark-border rounded-lg p-6",children:[s.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Tracked channels"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[s.jsx("input",{value:m,onChange:e=>x(e.target.value),placeholder:"Discord channel ID",className:"bg-black/20 border border-dark-border rounded px-3 py-2 text-white"}),s.jsx("input",{value:h,onChange:e=>p(e.target.value),placeholder:"Channel name",className:"bg-black/20 border border-dark-border rounded px-3 py-2 text-white"}),s.jsx("button",{onClick:N,disabled:!m.trim()||!h.trim()||null!==b,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded",children:"Add"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[0===r.length&&s.jsx("div",{className:"text-gray-400",children:"No tracked channels."}),r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-black/20 border border-dark-border rounded px-3 py-2",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-white font-medium",children:e.channel_name}),s.jsx("div",{className:"text-xs text-gray-400",children:e.discord_channel_id})]}),s.jsx("button",{onClick:()=>j(e.id),disabled:null!==b,className:"px-3 py-1 bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white rounded text-sm",children:"Remove"})]},e.id))]})]}),(0,s.jsxs)("section",{className:"bg-dark-card border border-dark-border rounded-lg p-6",children:[s.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Staff users"}),(0,s.jsxs)("div",{className:"space-y-4",children:[0===f.length&&s.jsx("div",{className:"text-gray-400",children:"No staff users found."}),f.map(e=>(0,s.jsxs)("div",{className:"bg-black/20 border border-dark-border rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-white font-semibold",children:[e.roblox_username||e.discord_username," ",(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["#",e.id]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["Rank: ",e.rank??"N/A"," ",e.rank_name?`(${e.rank_name})`:""," • Status: ",e.status]})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["active","inactive","pending_verification"].map(t=>s.jsx("button",{onClick:()=>v(e,t),disabled:null!==b,className:`px-3 py-1 rounded text-sm border ${e.status===t?"bg-blue-600 border-blue-500 text-white":"bg-transparent border-dark-border text-gray-200"} disabled:opacity-50`,children:t},t))})]}),(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("div",{className:"text-sm text-gray-300 mb-2",children:"Permissions (override)"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(t=>(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-black/20 border border-dark-border rounded px-2 py-1",children:[s.jsx("span",{className:"text-xs text-gray-200",children:t}),s.jsx("button",{onClick:()=>y(e,t,!0),disabled:null!==b,className:"text-xs px-2 py-0.5 rounded bg-green-600 hover:bg-green-700 disabled:opacity-50",children:"Grant"}),s.jsx("button",{onClick:()=>y(e,t,!1),disabled:null!==b,className:"text-xs px-2 py-0.5 rounded bg-red-600 hover:bg-red-700 disabled:opacity-50",children:"Revoke"})]},t))})]})]},e.id))]})]})]})}},4690:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>d,a:()=>l});var s=r(326),a=r(7577),n=r(1471);let i=(0,a.createContext)(void 0);function d({children:e}){let[t,r]=(0,a.useState)(null),[d,l]=(0,a.useState)(!0),[o,c]=(0,a.useState)(!1),u=async()=>{try{return}catch(e){console.error("Error fetching user:",e),r(null)}finally{l(!1)}},m=async()=>{try{let e=await n.Mh.getStatus();c(e.data.verified),e.data.verified&&await u()}catch(e){console.error("Error checking verification:",e)}};return s.jsx(i.Provider,{value:{user:t,loading:d,isVerified:o,refreshUser:u,checkVerification:m},children:e})}function l(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1471:(e,t,r)=>{"use strict";r.d(t,{Mh:()=>d,au:()=>o,bM:()=>c,kv:()=>i,vD:()=>l});var s=r(4464);let a=process.env.NEXT_PUBLIC_API_URL||"/api",n=s.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>e),n.interceptors.response.use(e=>e,e=>(e.response?.status,Promise.reject(e)));let i={getMe:()=>n.get("/auth/me"),logout:()=>n.post("/auth/logout")},d={requestCode:()=>n.post("/verification/roblox/request"),verify:(e,t)=>n.post("/verification/roblox/verify",{roblox_username:e,emoji_code:t}),getStatus:()=>n.get("/verification/roblox/status")},l={getStats:()=>n.get("/dashboard/stats"),getInfractions:()=>n.get("/dashboard/infractions"),getAnalytics:()=>n.get("/dashboard/analytics")},o={list:e=>n.get("/tickets",{params:{status:e}}),claim:e=>n.post(`/tickets/${e}/claim`),resolve:e=>n.post(`/tickets/${e}/resolve`)},c={getUsers:()=>n.get("/management/users"),updateUserPermission:(e,t,r)=>n.put(`/management/users/${e}/permissions`,{permission:t,granted:r}),updateUserStatus:(e,t)=>n.put(`/management/users/${e}/status`,{status:t}),getTrackedChannels:()=>n.get("/management/tracked-channels"),addTrackedChannel:(e,t)=>n.post("/management/tracked-channels",{discord_channel_id:e,channel_name:t}),removeTrackedChannel:e=>n.delete(`/management/tracked-channels/${e}`)}},6989:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/workspace/frontend/src/app/(dashboard)/layout.tsx#default`)},1856:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/workspace/frontend/src/app/(dashboard)/management/page.tsx#default`)},6694:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>l});var s=r(9510),a=r(5317),n=r.n(a);r(5023);var i=r(8570);let d=(0,i.createProxy)(String.raw`/workspace/frontend/src/context/AuthContext.tsx#AuthProvider`);(0,i.createProxy)(String.raw`/workspace/frontend/src/context/AuthContext.tsx#useAuth`);let l={title:"Panora Connect Employees",description:"Authorized employees only — manage internal operations."};function o({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:n().className,children:s.jsx(d,{children:e})})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[306,404],()=>r(4643));module.exports=s})();