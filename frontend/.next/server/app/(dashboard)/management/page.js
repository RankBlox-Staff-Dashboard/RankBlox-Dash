(()=>{var e={};e.id=486,e.ids=[486],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},4643:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),r(1856),r(6989),r(5866),r(6694);var s=r(3191),a=r(8716),n=r(7922),i=r.n(n),l=r(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let o=["",{children:["(dashboard)",{children:["management",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1856)),"/workspace/frontend/src/app/(dashboard)/management/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6989)),"/workspace/frontend/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6694)),"/workspace/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/workspace/frontend/src/app/(dashboard)/management/page.tsx"],u="/(dashboard)/management/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/management/page",pathname:"/management",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3021:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},2001:(e,t,r)=>{Promise.resolve().then(r.bind(r,4690))},4149:(e,t,r)=>{Promise.resolve().then(r.bind(r,784))},9874:(e,t,r)=>{Promise.resolve().then(r.bind(r,4072))},784:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var s=r(326),a=r(7577),n=r(5047),i=r(4690),l=r(434),d=r(4319),o=r(8307),c=r(949),u=r(7069),x=r(6671),m=r(8378),h=r(4019),p=r(748),b=r(1471);let g=[{name:"Overview",path:"/overview",icon:d.Z},{name:"Lookup",path:"/tickets",icon:o.Z},{name:"Infractions",path:"/infractions",icon:c.Z},{name:"Analytics",path:"/analytics",icon:u.Z},{name:"Payouts",path:"/payouts",icon:x.Z},{name:"Settings",path:"/settings",icon:m.Z}];function f(){let[e,t]=(0,a.useState)(!1),r=(0,n.usePathname)(),{user:d}=(0,i.a)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("header",{className:"sticky top-0 z-50 flex items-center justify-between px-4 py-3 bg-black/80 backdrop-blur-md border-b border-white/10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>t(!e),className:"p-2 rounded-lg hover:bg-white/10 transition",children:e?s.jsx(h.Z,{className:"w-5 h-5 text-white"}):s.jsx(p.Z,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:"\uD83D\uDD17"}),s.jsx("span",{className:"text-lg font-bold text-white",children:"Panora Staff"})]})]}),s.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${d?.rank?d.rank>=16&&d.rank<=255?"bg-red-600":d.rank>=8?"bg-purple-600":"bg-green-600":"bg-blue-600"} text-white`,children:d?.rank_name?d.rank_name:"Staff"})]}),e&&s.jsx("div",{className:"fixed inset-0 z-40 bg-black/90 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"pt-20 px-4",children:[s.jsx("nav",{className:"space-y-2",children:g.map(e=>{let a=r===e.path,n=e.icon;return(0,s.jsxs)(l.default,{href:e.path,onClick:()=>t(!1),className:`flex items-center gap-3 px-4 py-3 rounded-xl transition ${a?"bg-white text-black":"text-white/70 hover:bg-white/10 hover:text-white"}`,children:[s.jsx(n,{className:"w-5 h-5",strokeWidth:2}),s.jsx("span",{className:"font-medium",children:e.name})]},e.path)})}),s.jsx("div",{className:"mt-8 pt-4 border-t border-white/10",children:(0,s.jsxs)("button",{onClick:async()=>{try{await b.kv.logout()}catch{}finally{localStorage.removeItem("token"),window.location.href="/login"}},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-400 hover:bg-red-500/10 transition",children:[s.jsx("span",{children:"\uD83D\uDEAA"}),s.jsx("span",{className:"font-medium",children:"Logout"})]})})]})})]})}function v({children:e}){(0,n.useRouter)();let{user:t,loading:r,verification:l,isFullyVerified:d,refreshUser:o}=(0,i.a)(),[c,u]=(0,a.useState)(!0);return r||c?s.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsx("div",{className:"animate-pulse text-white/60 text-lg",children:"Loading..."})}):t&&d?(0,s.jsxs)("div",{className:"min-h-screen bg-black",children:[s.jsx(f,{}),s.jsx("main",{className:"px-4 py-4 pb-8 max-w-lg mx-auto",children:e}),s.jsx("footer",{className:"py-6 text-center text-white/40 text-sm",children:"\xa9 2025 Panora Connect LLC. All rights reserved."})]}):null}},4072:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(326),a=r(7577),n=r(4690),i=r(1471);let l=["VIEW_DASHBOARD","VIEW_TICKETS","CLAIM_TICKETS","VIEW_INFRACTIONS","VIEW_ALL_INFRACTIONS","ISSUE_INFRACTIONS","VOID_INFRACTIONS","VIEW_ANALYTICS","MANAGE_PERMISSIONS","MANAGE_USERS","MANAGE_CHANNELS"];function d(){let{user:e}=(0,n.a)(),{users:t,channels:r,loading:d,error:o,refresh:c}=function(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)([]),[n,l]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null);return{users:e,channels:r,loading:n,error:d,refresh:async()=>{try{l(!0),o(null);let[e,r]=await Promise.all([i.bM.getUsers(),i.bM.getTrackedChannels()]);t(e.data),s(r.data)}catch(e){o(e.response?.data?.error||"Failed to load management data")}finally{l(!1)}}}}(),u=!!(e?.rank&&e.rank>=16&&e.rank<=255),[x,m]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[b,g]=(0,a.useState)(null),f=(0,a.useMemo)(()=>t.filter(e=>null!==e.rank),[t]);if(!u)return(0,s.jsxs)("div",{className:"flex-1 p-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Management"}),s.jsx("div",{className:"text-red-400",children:"You are not authorized to view this page."})]});let v=async(e,t)=>{g(`status:${e.id}`);try{await i.bM.updateUserStatus(e.id,t),await c()}finally{g(null)}},y=async(e,t,r)=>{g(`perm:${e.id}:${t}`);try{await i.bM.updateUserPermission(e.id,t,r),await c()}finally{g(null)}},k=async()=>{g("addChannel");try{await i.bM.addTrackedChannel(x.trim(),h.trim()),m(""),p(""),await c()}finally{g(null)}},j=async e=>{g(`rmChannel:${e}`);try{await i.bM.removeTrackedChannel(e),await c()}finally{g(null)}};return(0,s.jsxs)("div",{className:"flex-1 p-8 space-y-10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Management"}),s.jsx("button",{onClick:c,className:"px-4 py-2 bg-dark-card border border-dark-border rounded text-white hover:bg-dark-border transition",children:"Refresh"})]}),d&&s.jsx("div",{className:"text-gray-400",children:"Loading management data..."}),o&&s.jsx("div",{className:"text-red-400",children:o}),(0,s.jsxs)("section",{className:"bg-dark-card border border-dark-border rounded-lg p-6",children:[s.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Tracked channels"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[s.jsx("input",{value:x,onChange:e=>m(e.target.value),placeholder:"Discord channel ID",className:"bg-black/20 border border-dark-border rounded px-3 py-2 text-white"}),s.jsx("input",{value:h,onChange:e=>p(e.target.value),placeholder:"Channel name",className:"bg-black/20 border border-dark-border rounded px-3 py-2 text-white"}),s.jsx("button",{onClick:k,disabled:!x.trim()||!h.trim()||null!==b,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded",children:"Add"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[0===r.length&&s.jsx("div",{className:"text-gray-400",children:"No tracked channels."}),r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-black/20 border border-dark-border rounded px-3 py-2",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-white font-medium",children:e.channel_name}),s.jsx("div",{className:"text-xs text-gray-400",children:e.discord_channel_id})]}),s.jsx("button",{onClick:()=>j(e.id),disabled:null!==b,className:"px-3 py-1 bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white rounded text-sm",children:"Remove"})]},e.id))]})]}),(0,s.jsxs)("section",{className:"bg-dark-card border border-dark-border rounded-lg p-6",children:[s.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Staff users"}),(0,s.jsxs)("div",{className:"space-y-4",children:[0===f.length&&s.jsx("div",{className:"text-gray-400",children:"No staff users found."}),f.map(e=>(0,s.jsxs)("div",{className:"bg-black/20 border border-dark-border rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-white font-semibold",children:[e.roblox_username||e.discord_username," ",(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["#",e.id]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["Rank: ",e.rank??"N/A"," ",e.rank_name?`(${e.rank_name})`:""," • Status: ",e.status]})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["active","inactive","pending_verification"].map(t=>s.jsx("button",{onClick:()=>v(e,t),disabled:null!==b,className:`px-3 py-1 rounded text-sm border ${e.status===t?"bg-blue-600 border-blue-500 text-white":"bg-transparent border-dark-border text-gray-200"} disabled:opacity-50`,children:t},t))})]}),(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("div",{className:"text-sm text-gray-300 mb-2",children:"Permissions (override)"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(t=>(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-black/20 border border-dark-border rounded px-2 py-1",children:[s.jsx("span",{className:"text-xs text-gray-200",children:t}),s.jsx("button",{onClick:()=>y(e,t,!0),disabled:null!==b,className:"text-xs px-2 py-0.5 rounded bg-green-600 hover:bg-green-700 disabled:opacity-50",children:"Grant"}),s.jsx("button",{onClick:()=>y(e,t,!1),disabled:null!==b,className:"text-xs px-2 py-0.5 rounded bg-red-600 hover:bg-red-700 disabled:opacity-50",children:"Revoke"})]},t))})]})]},e.id))]})]})]})}},4690:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>i,a:()=>l});var s=r(326),a=r(7577);r(1471);let n=(0,a.createContext)(void 0);function i({children:e}){let[t,r]=(0,a.useState)(null),[i,l]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null),c=(0,a.useCallback)(()=>{r(null),o(null)},[]),u=(0,a.useCallback)(e=>{},[]),x=(0,a.useCallback)(async()=>{try{return null}catch(e){return console.error("Error fetching user:",e),(e.response?.status===401||e.response?.status===403)&&c(),null}finally{l(!1)}},[c]),m=d?.complete??!1;return s.jsx(n.Provider,{value:{user:t,loading:i,verification:d,isFullyVerified:m,refreshUser:x,updateToken:u,logout:c},children:e})}function l(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1471:(e,t,r)=>{"use strict";r.d(t,{Mh:()=>d,au:()=>c,bM:()=>u,bR:()=>n,kv:()=>l,vD:()=>o});var s=r(4464);let a=process.env.NEXT_PUBLIC_API_URL||"https://staffapp-9q1t.onrender.com/api";function n(){return a.replace(/\/$/,"")}let i=s.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>e),i.interceptors.response.use(e=>e,e=>(e.response?.status,Promise.reject(e)));let l={getMe:()=>i.get("/auth/me"),logout:()=>i.post("/auth/logout")},d={requestCode:()=>i.post("/verification/roblox/request"),verify:(e,t)=>i.post("/verification/roblox/verify",{roblox_username:e,emoji_code:t}),getStatus:()=>i.get("/verification/roblox/status")},o={getStats:()=>i.get("/dashboard/stats"),getInfractions:()=>i.get("/dashboard/infractions"),getAnalytics:()=>i.get("/dashboard/analytics")},c={list:e=>i.get("/tickets",{params:{status:e}}),claim:e=>i.post(`/tickets/${e}/claim`),resolve:e=>i.post(`/tickets/${e}/resolve`)},u={getUsers:()=>i.get("/management/users"),updateUserPermission:(e,t,r)=>i.put(`/management/users/${e}/permissions`,{permission:t,granted:r}),updateUserStatus:(e,t)=>i.put(`/management/users/${e}/status`,{status:t}),getTrackedChannels:()=>i.get("/management/tracked-channels"),addTrackedChannel:(e,t)=>i.post("/management/tracked-channels",{discord_channel_id:e,channel_name:t}),removeTrackedChannel:e=>i.delete(`/management/tracked-channels/${e}`)}},6989:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/workspace/frontend/src/app/(dashboard)/layout.tsx#default`)},1856:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/workspace/frontend/src/app/(dashboard)/management/page.tsx#default`)},6694:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>d});var s=r(9510),a=r(5317),n=r.n(a);r(5023);var i=r(8570);let l=(0,i.createProxy)(String.raw`/workspace/frontend/src/context/AuthContext.tsx#AuthProvider`);(0,i.createProxy)(String.raw`/workspace/frontend/src/context/AuthContext.tsx#useAuth`);let d={title:"Panora Connect Employees",description:"Authorized employees only — manage internal operations."};function o({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:n().className,children:s.jsx(l,{children:e})})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[306,218],()=>r(4643));module.exports=s})();