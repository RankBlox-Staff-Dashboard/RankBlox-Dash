(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[486],{4788:function(e,t,a){Promise.resolve().then(a.bind(a,2996))},1047:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},1671:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9388:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1817:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2431:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},2369:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5805:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},2996:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var s=a(7437),n=a(2265),r=a(1245),i=a(8223),l=a(9848),c=a(757),o=a(3180),d=a(1817),u=a(8906),h=a(5805),x=a(9205);let m=(0,x.Z)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var f=a(1047),p=a(6865),b=a(2431);let g=(0,x.Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),v=(0,x.Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var w=a(1671),y=a(9388);function j(e){return null!=e&&e>=254&&e<=255}function N(){let{user:e}=(0,r.a)(),{users:t,channels:a,loading:x,error:N,refresh:k}=function(){let[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)([]),[r,l]=(0,n.useState)(!0),[c,o]=(0,n.useState)(null),d=async()=>{try{l(!0),o(null);let[e,a]=await Promise.all([i.bM.getUsers(),i.bM.getTrackedChannels()]);t(e.data),s(a.data)}catch(t){var e,a;o((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.error)||"Failed to load management data")}finally{l(!1)}};return(0,n.useEffect)(()=>{d()},[]),{users:e,channels:a,loading:r,error:c,refresh:d}}(),{permissions:_,loading:S}=(0,l.T)(),I=(0,n.useMemo)(()=>_.includes("MANAGE_USERS")||_.includes("MANAGE_PERMISSIONS"),[_]),[Z,C]=(0,n.useState)("users"),[M,A]=(0,n.useState)(""),[E,L]=(0,n.useState)(""),[P,U]=(0,n.useState)(null),[T,q]=(0,n.useState)([]),[D,R]=(0,n.useState)(!1),[z,O]=(0,n.useState)([]),[H,B]=(0,n.useState)(!1),[V,F]=(0,n.useState)(!1),[G,K]=(0,n.useState)(null),[W,Y]=(0,n.useState)(""),[X,$]=(0,n.useState)("warning"),J=(0,n.useMemo)(()=>t.filter(e=>null!==e.rank),[t]);(0,n.useEffect)(()=>{"loa"===Z?Q():"infractions"===Z&&ee()},[Z]);let Q=async()=>{try{R(!0);let e=await i.bM.getLOARequests();q(e.data)}catch(e){console.error("Error fetching LOA requests:",e)}finally{R(!1)}},ee=async()=>{try{B(!0);let e=await i.bM.getAllInfractions();O(e.data)}catch(e){console.error("Error fetching infractions:",e)}finally{B(!1)}};if(S)return(0,s.jsx)("div",{className:"p-4 animate-fadeIn",children:(0,s.jsxs)(c.Z,{className:"p-8 text-center",children:[(0,s.jsx)(d.Z,{className:"w-8 h-8 animate-spin text-white/50 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white/60",children:"Loading..."})]})});if(!I)return(0,s.jsx)("div",{className:"p-4 animate-fadeIn",children:(0,s.jsxs)(c.Z,{className:"p-8 text-center",children:[(0,s.jsx)(u.Z,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-white/60",children:"You do not have permission to view this page."})]})});let et=async(e,t)=>{U("status:".concat(e.id));try{await i.bM.updateUserStatus(e.id,t),await k()}finally{U(null)}},ea=async()=>{U("addChannel");try{await i.bM.addTrackedChannel(M.trim(),E.trim()),A(""),L(""),await k()}finally{U(null)}},es=async e=>{U("rmChannel:".concat(e));try{await i.bM.removeTrackedChannel(e),await k()}finally{U(null)}},en=async(e,t)=>{U("loa:".concat(e));try{await i.bM.reviewLOA(e,t),await Q()}finally{U(null)}},er=async()=>{if(G&&W.trim()){U("issueInfraction");try{await i.bM.issueInfraction(G,W,X),F(!1),K(null),Y(""),$("warning"),await ee()}finally{U(null)}}},ei=async e=>{U("void:".concat(e));try{await i.bM.voidInfraction(e),await ee()}finally{U(null)}},el=e=>{switch(e){case"pending":return(0,s.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-500/30 text-yellow-300",children:"Pending"});case"approved":return(0,s.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-green-500/30 text-green-300",children:"Approved"});case"denied":return(0,s.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-red-500/30 text-red-300",children:"Denied"});default:return null}},ec=[{key:"users",label:"Staff Users",icon:h.Z},{key:"channels",label:"Tracked Channels",icon:m},{key:"loa",label:"LOA Requests",icon:f.Z},{key:"infractions",label:"Infractions",icon:p.Z}];return(0,s.jsxs)("div",{className:"space-y-4 animate-fadeIn",children:[(0,s.jsx)(c.Z,{className:"p-5",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-red-500/20 flex items-center justify-center",children:(0,s.jsx)(u.Z,{className:"w-5 h-5 text-red-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-bold text-white",children:"Management Panel"}),(0,s.jsx)("p",{className:"text-xs text-white/50",children:"Administrator controls for Atlanta High"})]})]}),(0,s.jsx)("button",{onClick:()=>{k(),"loa"===Z&&Q(),"infractions"===Z&&ee()},className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition",children:(0,s.jsx)(b.Z,{className:"w-5 h-5 text-white/70"})})]})}),(0,s.jsx)(c.Z,{className:"p-4",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:ec.map(e=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:()=>C(e.key),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all ".concat(Z===e.key?"bg-white text-black shadow-lg scale-105":"text-white/60 hover:bg-white/10 hover:text-white"),children:[(0,s.jsx)(t,{className:"w-4 h-4"}),e.label]},e.key)})})}),x&&(0,s.jsx)("div",{className:"text-center text-white/50 py-8",children:"Loading..."}),N&&(0,s.jsx)("div",{className:"text-center text-red-400 py-8",children:N}),"users"===Z&&(0,s.jsxs)(c.Z,{className:"p-5 animate-fadeIn",children:[(0,s.jsxs)("h3",{className:"text-base font-semibold text-white mb-4 flex items-center gap-2",children:[(0,s.jsx)(h.Z,{className:"w-5 h-5 text-white/70"}),"Staff Users (",J.length,")"]}),(0,s.jsx)("div",{className:"space-y-3",children:J.map(e=>(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-white/5 hover:bg-white/10 transition",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)(o.f,{robloxId:e.roblox_id,discordId:e.discord_id,discordAvatar:e.discord_avatar,alt:e.roblox_username||e.discord_username,size:40,className:"w-10 h-10"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-white font-medium",children:e.roblox_username||e.discord_username}),(0,s.jsxs)("div",{className:"text-xs text-white/50",children:[e.rank_name||"Rank ".concat(e.rank)," â€¢ ID: ",e.id]})]}),!j(e.rank)&&(0,s.jsx)("button",{onClick:()=>{K(e.id),F(!0)},className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition",children:"Issue Infraction"}),j(e.rank)&&(0,s.jsx)("span",{className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-yellow-500/20 text-yellow-300",children:"Immune"})]}),j(e.rank)?(0,s.jsx)("div",{className:"text-xs text-yellow-300/70",children:"This user has an immune rank and cannot have their status modified."}):(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["active","inactive","pending_verification"].map(t=>(0,s.jsx)("button",{onClick:()=>et(e,t),disabled:null!==P,className:"px-3 py-1 rounded-lg text-xs font-medium transition ".concat(e.status===t?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-white/5 text-white/60 hover:bg-white/10 border border-white/10"," disabled:opacity-50"),children:t.replace("_"," ")},t))})]},e.id))})]}),"channels"===Z&&(0,s.jsxs)(c.Z,{className:"p-5 animate-fadeIn",children:[(0,s.jsxs)("h3",{className:"text-base font-semibold text-white mb-4 flex items-center gap-2",children:[(0,s.jsx)(m,{className:"w-5 h-5 text-white/70"}),"Tracked Channels (",a.length,")"]}),(0,s.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,s.jsx)("input",{value:M,onChange:e=>A(e.target.value),placeholder:"Channel ID",className:"flex-1 px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm placeholder-white/30 focus:outline-none focus:border-blue-500/50"}),(0,s.jsx)("input",{value:E,onChange:e=>L(e.target.value),placeholder:"Channel Name",className:"flex-1 px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm placeholder-white/30 focus:outline-none focus:border-blue-500/50"}),(0,s.jsxs)("button",{onClick:ea,disabled:!M.trim()||!E.trim()||null!==P,className:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium disabled:opacity-50 transition flex items-center gap-2",children:[(0,s.jsx)(g,{className:"w-4 h-4"}),"Add"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[0===a.length&&(0,s.jsx)("div",{className:"text-white/50 text-sm text-center py-4",children:"No tracked channels"}),a.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-white/5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-white font-medium text-sm",children:e.channel_name}),(0,s.jsx)("div",{className:"text-xs text-white/40",children:e.discord_channel_id})]}),(0,s.jsx)("button",{onClick:()=>es(e.id),disabled:null!==P,className:"p-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-300 disabled:opacity-50 transition",children:(0,s.jsx)(v,{className:"w-4 h-4"})})]},e.id))]})]}),"loa"===Z&&(0,s.jsxs)(c.Z,{className:"p-5 animate-fadeIn",children:[(0,s.jsxs)("h3",{className:"text-base font-semibold text-white mb-4 flex items-center gap-2",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 text-white/70"}),"LOA Requests"]}),D?(0,s.jsxs)("div",{className:"text-center py-8 text-white/50",children:[(0,s.jsx)(d.Z,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading..."]}):0===T.length?(0,s.jsx)("div",{className:"text-center py-8 text-white/50",children:"No LOA requests"}):(0,s.jsx)("div",{className:"space-y-3",children:T.map(e=>(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-white/5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-white font-medium",children:e.user_roblox_username||e.user_discord_username}),el(e.status)]}),(0,s.jsx)("span",{className:"text-xs text-white/40",children:new Date(e.created_at).toLocaleDateString()})]}),(0,s.jsxs)("p",{className:"text-sm text-white/60 mb-2",children:[new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString()]}),(0,s.jsx)("p",{className:"text-xs text-white/50 mb-3",children:e.reason}),"pending"===e.status&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>en(e.id,"approved"),disabled:null!==P,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg bg-green-500/20 text-green-300 hover:bg-green-500/30 transition text-sm disabled:opacity-50",children:[(0,s.jsx)(w.Z,{className:"w-4 h-4"}),"Approve"]}),(0,s.jsxs)("button",{onClick:()=>en(e.id,"denied"),disabled:null!==P,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition text-sm disabled:opacity-50",children:[(0,s.jsx)(y.Z,{className:"w-4 h-4"}),"Deny"]})]})]},e.id))})]}),"infractions"===Z&&(0,s.jsxs)(c.Z,{className:"p-5 animate-fadeIn",children:[(0,s.jsxs)("h3",{className:"text-base font-semibold text-white mb-4 flex items-center gap-2",children:[(0,s.jsx)(p.Z,{className:"w-5 h-5 text-yellow-400"}),"All Infractions"]}),H?(0,s.jsxs)("div",{className:"text-center py-8 text-white/50",children:[(0,s.jsx)(d.Z,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading..."]}):0===z.length?(0,s.jsx)("div",{className:"text-center py-8 text-white/50",children:"No infractions"}):(0,s.jsx)("div",{className:"space-y-3",children:z.map(e=>(0,s.jsxs)("div",{className:"p-4 rounded-xl ".concat(e.voided?"bg-white/5 opacity-60":"strike"===e.type?"bg-red-500/10 border border-red-500/20":"bg-yellow-500/10 border border-yellow-500/20"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-white font-medium",children:e.user_roblox_username||e.user_discord_username}),(0,s.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full ".concat(e.voided?"bg-white/10 text-white/50":"strike"===e.type?"bg-red-500/30 text-red-300":"bg-yellow-500/30 text-yellow-300"),children:e.voided?"Voided":e.type})]}),(0,s.jsx)("span",{className:"text-xs text-white/40",children:new Date(e.created_at).toLocaleDateString()})]}),(0,s.jsx)("p",{className:"text-sm text-white/60 mb-1",children:e.reason}),(0,s.jsxs)("p",{className:"text-xs text-white/40 mb-2",children:["By ",e.issued_by_username||"System"]}),!e.voided&&(0,s.jsx)("button",{onClick:()=>ei(e.id),disabled:null!==P,className:"px-3 py-1.5 rounded-lg bg-white/10 text-white/70 hover:bg-white/20 transition text-xs disabled:opacity-50",children:"Void Infraction"})]},e.id))})]}),V&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fadeIn",children:(0,s.jsxs)("div",{className:"w-full max-w-md bg-zinc-900 rounded-2xl border border-white/10 p-6 animate-scaleIn",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-white mb-4",children:"Issue Infraction"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white/70 mb-2",children:"User"}),(0,s.jsxs)("select",{value:G||"",onChange:e=>K(Number(e.target.value)),className:"w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 text-white focus:outline-none focus:border-blue-500/50",children:[(0,s.jsx)("option",{value:"",children:"Select a user"}),J.filter(e=>!j(e.rank)).map(e=>(0,s.jsx)("option",{value:e.id,children:e.roblox_username||e.discord_username},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white/70 mb-2",children:"Type"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>$("warning"),className:"flex-1 px-4 py-2 rounded-xl transition ".concat("warning"===X?"bg-yellow-500/30 text-yellow-300 border border-yellow-500/50":"bg-white/5 text-white/60 border border-white/10"),children:"Warning"}),(0,s.jsx)("button",{onClick:()=>$("strike"),className:"flex-1 px-4 py-2 rounded-xl transition ".concat("strike"===X?"bg-red-500/30 text-red-300 border border-red-500/50":"bg-white/5 text-white/60 border border-white/10"),children:"Strike"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-white/70 mb-2",children:"Reason"}),(0,s.jsx)("textarea",{value:W,onChange:e=>Y(e.target.value),rows:3,placeholder:"Enter the reason for this infraction...",className:"w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-blue-500/50 resize-none"})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,s.jsx)("button",{onClick:()=>{F(!1),K(null),Y("")},className:"flex-1 px-4 py-3 rounded-xl bg-white/5 text-white font-medium hover:bg-white/10 transition",children:"Cancel"}),(0,s.jsx)("button",{onClick:er,disabled:!G||!W.trim()||null!==P,className:"flex-1 px-4 py-3 rounded-xl bg-red-500/20 text-red-300 font-medium hover:bg-red-500/30 transition disabled:opacity-50",children:"Issue Infraction"})]})]})]})})]})}},3180:function(e,t,a){"use strict";a.d(t,{f:function(){return l}});var s=a(7437),n=a(3145),r=a(2369),i=a(2269);function l(e){let{robloxId:t,discordId:a,discordAvatar:l,alt:c,size:o=40,className:d=""}=e,{avatarUrl:u,loading:h,error:x}=(0,i.k)(t),m=(0,i.g)(a,l),f=t&&u?u:m;return h&&t?(0,s.jsx)("div",{className:"rounded-full bg-white/10 flex items-center justify-center ".concat(d),style:{width:o,height:o},children:(0,s.jsx)(r.Z,{className:"w-1/2 h-1/2 text-white/40"})}):(0,s.jsx)(n.default,{src:f,alt:c,width:o,height:o,className:"rounded-full ".concat(d),unoptimized:!0})}},757:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437),n=a(4457);function r(e){let{className:t,children:a,style:r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("rounded-[26px] border border-white/10 bg-gradient-to-b from-white/[0.06] to-white/[0.02] shadow-[0_0_0_1px_rgba(255,255,255,0.04),0_24px_70px_rgba(0,0,0,0.78)]",t),style:r,children:a})}},1245:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return l},a:function(){return c}});var s=a(7437),n=a(2265),r=a(8223);let i=(0,n.createContext)(void 0);function l(e){var t;let{children:a}=e,[l,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),[u,h]=(0,n.useState)(null),x=(0,n.useCallback)(()=>{localStorage.removeItem("token"),c(null),h(null)},[]),m=(0,n.useCallback)(e=>{localStorage.setItem("token",e)},[]),f=(0,n.useCallback)(async()=>{try{if(!localStorage.getItem("token"))return c(null),h(null),d(!1),null;let e=(await r.kv.getMe()).data;return c(e),e.verification?h(e.verification):h({discord:!!e.discord_id,roblox:!!e.roblox_id,active:"active"===e.status,rank:null!==e.rank,complete:"active"===e.status&&null!==e.roblox_id&&null!==e.rank,next_step:e.roblox_id?"active"!==e.status?"activation":null:"roblox"}),e}catch(a){var e,t;return console.error("Error fetching user:",a),((null===(e=a.response)||void 0===e?void 0:e.status)===401||(null===(t=a.response)||void 0===t?void 0:t.status)===403)&&x(),null}finally{d(!1)}},[x]);(0,n.useEffect)(()=>{f()},[f]);let p=null!==(t=null==u?void 0:u.complete)&&void 0!==t&&t;return(0,s.jsx)(i.Provider,{value:{user:l,loading:o,verification:u,isFullyVerified:p,refreshUser:f,updateToken:m,logout:x},children:a})}function c(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9848:function(e,t,a){"use strict";a.d(t,{T:function(){return r}});var s=a(2265),n=a(8223);function r(){let[e,t]=(0,s.useState)([]),[a,r]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=await n.K5.getPermissions();t(e.data.permissions)}catch(e){console.error("Error fetching permissions:",e)}finally{r(!1)}})()},[]),{permissions:e,loading:a,hasPermission:t=>!a&&e.includes(t)}}},2269:function(e,t,a){"use strict";a.d(t,{g:function(){return i},k:function(){return r}});var s=a(2265);let n=new Map;function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"150x150",[a,r]=(0,s.useState)(null),[i,l]=(0,s.useState)(!1),[c,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(!e){r(null);return}let a="".concat(e,":").concat(t);if(n.has(a)){r(n.get(a));return}let s=!1;return async function(){l(!0),o(null);try{let i=await fetch("https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=".concat(e,"&size=").concat(t,"&format=Png&isCircular=false"));if(!i.ok)throw Error("Failed to fetch avatar: ".concat(i.status));let l=await i.json();if(!s&&l.data&&l.data.length>0&&l.data[0].imageUrl){let e=l.data[0].imageUrl;n.set(a,e),r(e)}else s||r(null)}catch(e){s||(console.error("Error fetching Roblox avatar:",e),o(e instanceof Error?e:Error("Failed to fetch avatar")),r(null))}finally{s||l(!1)}}(),()=>{s=!0}},[e,t]),{avatarUrl:a,loading:i,error:c}}function i(e,t){if(t)return"https://cdn.discordapp.com/avatars/".concat(e,"/").concat(t,".png?size=128");let a=parseInt(e.slice(-1))%5;return"https://cdn.discordapp.com/embed/avatars/".concat(a,".png")}},4457:function(e,t,a){"use strict";function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}a.d(t,{cn:function(){return s}})},8223:function(e,t,a){"use strict";a.d(t,{K5:function(){return x},Mh:function(){return o},Yd:function(){return u},au:function(){return h},bM:function(){return m},bR:function(){return r},kv:function(){return c},vD:function(){return d}});var s=a(3464);let n=a(257).env.NEXT_PUBLIC_API_URL||"https://staffapp-9q1t.onrender.com/api";function r(){return n.replace(/\/$/,"")}let i=s.Z.create({baseURL:n,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e});let l=!1;i.interceptors.response.use(e=>e,e=>{var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!l){let e=window.location.pathname;"/login"===e||e.startsWith("/auth/")||"/"===e||(l=!0,localStorage.removeItem("token"),window.location.replace("/login"),setTimeout(()=>{l=!1},2e3))}return Promise.reject(e)});let c={getMe:()=>i.get("/auth/me"),logout:()=>i.post("/auth/logout")},o={requestCode:()=>i.post("/verification/roblox/request"),verify:(e,t)=>i.post("/verification/roblox/verify",{roblox_username:e,emoji_code:t}),getStatus:()=>i.get("/verification/roblox/status")},d={getStats:()=>i.get("/dashboard/stats"),getInfractions:()=>i.get("/dashboard/infractions"),getAnalytics:()=>i.get("/dashboard/analytics")},u={getStatus:()=>i.get("/dashboard/loa/status"),getRequests:()=>i.get("/dashboard/loa"),create:(e,t,a)=>i.post("/dashboard/loa",{start_date:e,end_date:t,reason:a}),cancel:e=>i.delete("/dashboard/loa/".concat(e))},h={list:e=>i.get("/tickets",{params:{status:e}}),claim:e=>i.post("/tickets/".concat(e,"/claim")),resolve:e=>i.post("/tickets/".concat(e,"/resolve"))},x={getPermissions:()=>i.get("/permissions"),checkPermission:e=>i.get("/permissions/check",{params:{permission:e}})},m={getUsers:()=>i.get("/management/users"),updateUserPermission:(e,t,a)=>i.put("/management/users/".concat(e,"/permissions"),{permission:t,granted:a}),updateUserStatus:(e,t)=>i.put("/management/users/".concat(e,"/status"),{status:t}),getTrackedChannels:()=>i.get("/management/tracked-channels"),addTrackedChannel:(e,t)=>i.post("/management/tracked-channels",{discord_channel_id:e,channel_name:t}),removeTrackedChannel:e=>i.delete("/management/tracked-channels/".concat(e)),getLOARequests:e=>i.get("/management/loa",{params:{status:e}}),reviewLOA:(e,t,a)=>i.put("/management/loa/".concat(e,"/review"),{status:t,review_notes:a}),getAllInfractions:()=>i.get("/management/infractions"),issueInfraction:(e,t,a)=>i.post("/management/infractions",{user_id:e,reason:t,type:a}),voidInfraction:e=>i.put("/management/infractions/".concat(e,"/void")),getUserInfractions:e=>i.get("/management/users/".concat(e,"/infractions"))}}},function(e){e.O(0,[464,304,971,117,744],function(){return e(e.s=4788)}),_N_E=e.O()}]);